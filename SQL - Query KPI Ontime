select
    shipment_id
    ,flag
    ,order_category
    ,buyer_addr_state
    ,buyer_addr_city
    ,buyer_addr_district
    ,buyer_region
    ,whs_id
    ,o_type
    ,station_id
    ,station_name
    ,inbound_ctime
    ,is_duplicate_receive
    ,lh_out
    ,trip_id
    ,trip_source
    ,lh_in
    ,to_number_in
    ,to_number_out
    ,dest_station_name
    ,checkin_geofence_inbound
    ,trip_ata
    ,unseal_time
    ,soc_lhtransported
    ,soc_received
    ,soc_packed
    ,min_soc_packed
    ,min_soc_lhpacked
    ,checkin_geofence_outbound
    ,trip_ata_before_seal_time
    ,soc_lhpacked
    ,seal_time
    ,soc_lhtransporting
    ,actual_start_kpi_ontime
    ,actual_end_kpi_ontime_packed
    ,actual_end_kpi_ontime_lhpacked
    ,next_station_id_linehaul
    ,handover_time
    ,sla_start_ontime
    ,sla_eta_packed_ontime_origin
    ,sla_eta_packed_ontime_extend_1_cot
    ,sla_eta_packed_ontime_extend_2_cot
    ,sla_eta_packed_ontime_extend_3_cot
    ,sla_eta_lhpacked_ontime_origin
    ,sla_eta_lhpacked_ontime_extend_1_cot
    ,sla_eta_lhpacked_ontime_extend_2_cot
    ,sla_eta_lhpacked_ontime_extend_3_cot
    ,sla_eta_overdue_origin
    ,sla_eta_overdue_extend_1_cot
    ,sla_eta_overdue_extend_2_cot
    ,sla_eta_overdue_extend_3_cot
    ,key
    ,key_day
    ,kpi_period
    ,sla_eta_packed_ontime
    ,sla_eta_lhpacked_ontime
    ,sla_eta_overdue
    ,kpi_overdue_period
    ,kpi_lhpacked_ontime_period
    ,kpi_packed_ontime
    ,kpi_lhpacked_ontime
    ,lhpacked_ontime_fault
    ,kpi_overdue
from dev_vnbi_spx.south_soc_kpi_ontime_outdate
WHERE station_name IN ('HCM Mega SOC')
AND DATE(sla_eta_lhpacked_ontime_origin) BETWEEN date '2024-07-15' AND date '2024-07-28'
AND kpi_lhpacked_ontime IN ('Late')
;
